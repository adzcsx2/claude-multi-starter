#!/usr/bin/env python3
"""
sync-config - Sync local project config to global config

Usage:
    sync-config

Description:
    Copies .ccb_config/ccb.config to ~/.ccb/ccb.config
"""

from __future__ import annotations

import sys
from pathlib import Path

def main():
    """Sync project config to global config."""
    # 查找项目配置
    local_config = Path.cwd() / ".ccb_config" / "ccb.config"
    if not local_config.exists():
        local_config = Path.cwd() / "ccb.config"
    
    if not local_config.exists():
        print("错误: 找不到本地配置文件")
        print(f"请在以下位置之一创建配置:")
        print(f"  - {Path.cwd() / '.ccb_config' / 'ccb.config'}")
        print(f"  - {Path.cwd() / 'ccb.config'}")
        sys.exit(1)
    
    # 全局配置路径
    global_config = Path.home() / ".ccb" / "ccb.config"
    global_config.parent.mkdir(parents=True, exist_ok=True)
    
    # 复制配置
    try:
        import shutil
        shutil.copy2(local_config, global_config)
        print(f"✓ 已同步配置:")
        print(f"  从: {local_config}")
        print(f"  到: {global_config}")
    except Exception as e:
        print(f"错误: 同步失败 - {e}", file=sys.stderr)
        sys.exit(1)


if __name__ == "__main__":
    main()
